"use strict";(function(){"use strict";const d={API_BASE:"https://app.ccpapp.xyz",API_ENDPOINT:"/social-widgets/render",AUTO_INIT:!0,DEBUG:!1,SELECTOR:".social-widget",LOADING_CLASS:"sw-loading",LOADED_CLASS:"sw-loaded",ERROR_CLASS:"sw-error",MODULES_PATH:"/sw/min/modules/"},o={log:function(e,i="info"){d.DEBUG&&console[i]("[SocialWidget]",e)},debounce:function(e,i){let t;return function(...s){const c=()=>{clearTimeout(t),e(...s)};clearTimeout(t),t=setTimeout(c,i)}},addClass:function(e,i){e&&e.classList&&e.classList.add(i)},removeClass:function(e,i){e&&e.classList&&e.classList.remove(i)},hasClass:function(e,i){return e&&e.classList&&e.classList.contains(i)}},l={async fetchWidget(e){try{o.log(`Fetching widget data for ID: ${e}`);const i=await fetch(`${d.API_BASE}${d.API_ENDPOINT}/${e}`,{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json"}});if(!i.ok)throw new Error(`Error HTTP: ${i.status}`);const t=await i.json();if(!t.success)throw new Error(t.message||"Error al obtener los datos del widget");return o.log("Datos del widget obtenidos","info"),t}catch(i){throw o.log(`Error al obtener los datos del widget: ${i.message}`,"error"),i}}};function r(e,i,t){if(i&&!document.querySelector(`link[href='${d.MODULES_PATH+i}']`)){const n=document.createElement("link");n.rel="stylesheet",n.href=d.MODULES_PATH+i,document.head.appendChild(n)}if(e&&!document.querySelector(`script[src='${d.MODULES_PATH+e}']`)){const n=document.createElement("script");n.src=d.MODULES_PATH+e,n.onload=t,document.body.appendChild(n)}else e&&t&&t()}window.SocialWidget={version:"1.0.0",init:function(){o.log("Inicializando SocialWidget"),this.loadLightbox();const e=document.querySelectorAll(d.SELECTOR);o.log(`Encontrados ${e.length} widget(s) para inicializar`),e.forEach((i,t)=>{this.renderWidget(i,t)})},loadLightbox:function(){r("lightbox.min.js","lightbox.min.css")},renderWidget:function(e,i=0){if(!e){o.log("No se proporcion\xF3 un contenedor para el renderizado del widget","error");return}const t=e.getAttribute("data-widget-id");if(!t){o.log("No se encontr\xF3 un widget-id en el atributo data-widget-id","error"),this.showError(e,"Falta el ID del widget");return}o.log(`Renderizando widget ${t} en el contenedor ${i}`),o.addClass(e,d.LOADING_CLASS),this.showLoading(e),l.fetchWidget(t).then(n=>{o.removeClass(e,d.LOADING_CLASS),o.addClass(e,d.LOADED_CLASS);const s=n.widget&&n.widget.layout?n.widget.layout:"grid";s==="slider"?r("slider.min.js","slider.min.css",function(){window.SocialWidget&&window.SocialWidget.Modules&&typeof window.SocialWidget.Modules.Slider?.render=="function"?window.SocialWidget.Modules.Slider.render(e,n):o.log("No se encontr\xF3 el renderizador de Slider despu\xE9s de cargar","error")}):s==="grid-2"?r("grid-2.min.js","grid-2.min.css",function(){window.SocialWidget&&window.SocialWidget.Modules&&typeof window.SocialWidget.Modules.Grid2?.render=="function"?window.SocialWidget.Modules.Grid2.render(e,n):o.log("No se encontr\xF3 el renderizador de Grid-2 despu\xE9s de cargar","error")}):r("grid.min.js","grid.min.css",function(){window.SocialWidget&&window.SocialWidget.Modules&&typeof window.SocialWidget.Modules.Grid?.render=="function"?window.SocialWidget.Modules.Grid.render(e,n):o.log("No se encontr\xF3 el renderizador de Grid despu\xE9s de cargar","error")})}).catch(n=>{o.removeClass(e,d.LOADING_CLASS),o.addClass(e,d.ERROR_CLASS),this.showError(e,n.message),o.log(`Error al renderizar el widget ${t}: ${n.message}`,"error")})},showLoading:function(e){e.innerHTML=`
                <div class="sw-loading-container">
                    <div class="sw-loading-spinner"></div>
                </div>
            `},showError:function(e,i){console.log(i)},destroy:function(e){const i=typeof e=="string"?document.querySelector(e):e;i&&(i.innerHTML="",o.removeClass(i,d.LOADING_CLASS),o.removeClass(i,d.LOADED_CLASS),o.removeClass(i,d.ERROR_CLASS))}};function a(){d.AUTO_INIT&&(document.readyState==="loading"?document.addEventListener("DOMContentLoaded",()=>{window.SocialWidget.init()}):window.SocialWidget.init(),window.addEventListener("load",()=>{const e=document.querySelectorAll(`${d.SELECTOR}:not(.${d.LOADED_CLASS}):not(.${d.LOADING_CLASS}):not(.${d.ERROR_CLASS})`);e.length>0&&(o.log(`Encontrados ${e.length} widget(s) sin inicializar despu\xE9s de la carga de la ventana`),e.forEach((i,t)=>{window.SocialWidget.renderWidget(i,t)}))}))}a(),o.log("Biblioteca SocialWidget cargada correctamente")})();
